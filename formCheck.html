<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>表单异步验证</title>
    <link rel="stylesheet" href="./dist/css/form.css">
</head>

<body>
    <form id="form" action="" name="registerForm">
        <table width="100%">
            <tbody>
                <tr>
                    <td class="listTdLeft">用户名：</td>
                    <td>
                        <div>
                            <input type="text" placeholder="" name="txtUserName" value="" class="input">
                            <span class="state"></span>
                        </div>
                        <div class="msg txtUserNameMsg color-red"></div>
                    </td>
                </tr>
                <tr>
                    <td class="listTdLeft">密码：</td>
                    <td>
                        <div>
                            <input type="password" name="txtPassword" value="" class="input">
                            <span class="state"></span>
                        </div>
                        <div class="msg txtPasswordMsg color-red"></div>
                    </td>
                </tr>
                <tr>
                    <td class="listTdLeft">重复密码：</td>
                    <td>
                        <div>
                            <input type="password" name="txtPassword2" value="" class="input">
                            <span class="state"></span>
                        </div>
                        <div class="msg txtPassword2Msg color-red"></div>
                    </td>
                </tr>
                <tr>
                    <td class="listTdLeft">初始金额：</td>
                    <td>
                        <div>
                            <input type="text" name="txtMoney" value="" class="input">
                            <span class="state"></span>
                        </div>
                        <div class="msg txtMoneyMsg color-red"></div>
                    </td>
                </tr>
                <tr>
                    <td class="listTdLeft">年龄：</td>
                    <td>
                        <div>
                            <input type="text" name="txtAge" value="" class="input">
                            <span class="state"></span>
                        </div>
                        <div class="msg txtAgeMsg color-red"></div>
                    </td>
                </tr>
                <tr>
                    <td class="listTdLeft">手机号码：</td>
                    <td>
                        <div>
                            <input type="text" name="txtMobilePhone" value="" class="input">
                            <span class="state"></span>
                        </div>
                        <div class="msg txtMobilePhoneMsg color-red"></div>
                    </td>
                </tr>
                <tr>
                    <td class="listTdLeft">验证码：</td>
                    <td>
                        <div>
                            <input type="text" name="txtValidatorsCode" value="" class="input">
                            <span class="state code"></span>
                            <button type="button" class="getCodeBtn">发送验证码</button>
                        </div>
                        <div class="msg txtValidatorsCodeMsg color-red"></div>
                    </td>
                </tr>
                <tr>
                    <td class="listTdLeft">图片验证码：</td>
                    <td>
                        <div>
                            <input type="text" name="txtImgValidatorsCode" value="" class="input">
                            <img src="#" alt="1213">
                            <span class="state"></span>
                        </div>
                        <div class="msg txtImgValidatorsCodeMsg color-red"></div>
                    </td>
                </tr>
                <tr>
                    <td class="listTdLeft">固定电话：</td>
                    <td>
                        <div>
                            <input type="text" name="txtTelephone" value="" class="input">
                            <span class="state">需加上前缀如：051-****</span>
                        </div>
                        <div class="msg txtTelephoneMsg color-red"></div>
                    </td>
                </tr>
                <tr>
                    <td class="listTdLeft">爱好：</td>
                    <td>
                        <table>
                            <tbody>
                                <tr>
                                    <td class="pdr10">
                                        <input type="checkbox" name="chkFunc" class="valign-m" value="1"><label class="valign-m" for="chkFunc">打篮球</label>
                                    </td>
                                    <td class="pdr10">
                                        <input type="checkbox" name="chkFunc" class="valign-m" value="2"><label class="valign-m" for="chkFunc">玩游戏</label>
                                    </td>
                                    <td class="pdr10">
                                        <input type="checkbox" name="chkFunc" class="valign-m" value="3"><label class="valign-m" for="chkFunc">看电影</label>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="msg chkFuncMsg color-red"></div>
                    </td>
                </tr>
                <tr>
                    <td class="listTdLeft">介绍：</td>
                    <td>
                        <div>
                            <textarea class="textarea" name="desc" id="" cols="30" rows="10"></textarea>
                        </div>
                        <div class="msg descMsg color-red"></div>
                    </td>
                </tr>
                <tr>
                    <td class="listTdLeft"></td>
                    <td></td>
                </tr>
                <tr>
                    <td class="listTdLeft"></td>
                    <td><button type="submit" class="btn-submit" style="width: 150px;">登录</button></td>
                </tr>
            </tbody>
        </table>
    </form>

    <!--[if IE]>
      <script type="text/javascript" src="./js/jquery-1.9.0.min.js"></script>
    <![endif]-->
    <!--[if !IE]><!-->
      <script type="text/javascript" src="./node_modules/jquery/dist/jquery.min.js"></script>
    <!--<![endif]-->

    <!-- 自制插件 -->
    <script type="text/javascript" src="./dist/js/form.check.js"></script>
    <script>
        var form = new FormCheck('#form', {
            fields: {
                chkFunc: {
                    selector: '.chkFuncMsg',
                    type: 'checkbox',
                    validators: {
                        onblur: true,
                        oninput: true,
                        notEmpty: {
                            message: '爱好不能为空'
                        }
                    }
                },
                desc: {
                    selector: '.descMsg',
                    validators: {
                        onblur: true,
                        notEmpty: {
                            message: '介绍不能为空'
                        }
                    }
                },
                txtUserName: {
                    selector: '.txtUserNameMsg',
                    validators: {
                        onblur: true,
                        oninput: true,
                        notEmpty: {
                            message: '用户名不能为空'
                        },
                        stringLength: {
                            max: 8,
                            message: '用户名长度不能超过8个字符'
                        },
                        regexp: {
                            regexp: /^[a-zA-Z0-9_\.]+$/,
                            message: '用户名只可以包括数字、字母和._'
                        }
                    }
                },
                txtPassword: {
                    selector: '.txtPasswordMsg',
                    validators: {
                        onblur: true,
                        notEmpty: {
                            message: '密码不能为空'
                        },
                        same: {
                            field: 'txtPassword2',
                            message: '两次密码不相同'
                        }
                    }
                },
                txtPassword2: {
                    selector: '.txtPassword2Msg',
                    validators: {
                        onblur: true,
                        notEmpty: {
                            message: '密码不能为空'
                        },
                        same: {
                            field: 'txtPassword',
                            message: '两次密码不相同'
                        }
                    }
                },
                txtMoney: {
                    selector: '.txtMoneyMsg',
                    validators: {
                        onblur: true,
                        number: {
                            type: 'float',
                            message: '只允许输入数字'
                        },
                        range: {
                            type: 'float',
                            max: 1000,
                            min: 0,
                            message: '初始金额需大于等于0并且小于等于1000'
                        }
                    }
                },
                txtAge: {
                    selector: '.txtAgeMsg',
                    validators: {
                        onblur: true,
                        number: {
                            type: 'Integer',
                            message: '只允许输入整数'
                        },
                        range: {
                            type: 'Integer',
                            min: 0,
                            message: '年龄不嫩小于0'
                        }
                    }
                },
                txtMobilePhone: {
                    selector: '.txtMobilePhoneMsg',
                    validators: {
                        onblur: true,
                        notEmpty: {
                            message: '手机号码不能为空'
                        },
                        mobilePhone: {
                            message: '手机号码格式不正确'
                        }
                    }
                },
                txtTelephone: {
                    selector: '.txtTelephoneMsg',
                    validators: {
                        onblur: true,
                        telephone: {
                            message: '电话格式不正确'
                        }
                    }
                },
                txtValidatorsCode: {
                    selector: '.txtValidatorsCodeMsg',
                    validators: {
                        onblur: true,
                        notEmpty: {
                            message: '验证码不能为空'
                        },
                        callback: {
                            message: '验证码错误',
                            callback: function (value) {
                                $.ajax({
                                    url: 'code.json',
                                    type: 'get',
                                    success: function (response) {
                                        if (response.code != value) {
                                            $('.txtValidatorsCodeMsg').text('验证码错误');
                                        }
                                    }
                                });

                                return true;
                            }
                        }
                    }
                },
                txtImgValidatorsCode: {
                    selector: '.txtImgValidatorsCodeMsg',
                    validators: {
                        onblur: true,
                        notEmpty: {
                            message: '图片验证码不能为空'
                        },
                        callback: {
                            message: '验证码错误',
                            callback: function (value) {
                                return value == '1213';
                            }
                        }
                    }
                }
            }
        });

        $('.btn-submit').click(function (e) {
            return form.checkAll();;
        });

        $('.getCodeBtn').click(function (e) {
            $('.code').text(1213);
        });
    </script>
</body>

</html>
